<div class="container py-3" style="min-height: 86vh; overflow:hidden;">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap">
    <h4 class="m-0">üìù Jobs</h4>
    <button class="btn btn-primary mt-2 mt-md-0" (click)="openCreateJob()">
      <i class="bi bi-plus-circle me-1"></i> Add Job
    </button>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="text-center my-4">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-2 text-muted">Loading jobs...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-danger">
    <i class="bi bi-exclamation-triangle-fill me-2"></i> {{ errorMessage }}
  </div>

  <!-- Job Cards -->
  <div class="row g-5" *ngIf="!isLoading && jobs.length > 0">
    <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex justify-content-center" *ngFor="let j of jobs">
      <div class="card themed-card">
        <div class="content d-flex flex-column h-100">
          <!-- Job Type -->
          <p class="heading">{{ j.type }}</p>

          <!-- Job Details -->
<p class="para mb-1"><strong>Status:</strong> {{ j.status }}</p>
<p class="para mb-1"><strong>Scheduled At:</strong> {{ j.scheduledAt | date:'d MMM yyyy, HH:mm' }}</p>
<p class="para mb-1"><strong>Field:</strong> {{ j.fieldName || j.fieldId }}</p>
<p class="para mb-2"><strong>Notes:</strong> {{ j.notes }}</p>
<p class="para mb-2"><strong>Created:</strong> {{ j.createdAt | date:'d MMMM' }}</p>

          <!-- Action Buttons -->
          <div class="mt-auto d-flex gap-2 flex-wrap">
            <button class="btn btn-sm btn-outline-primary flex-grow-1" (click)="openEditJob(j)">
              <i class="bi bi-pencil-square"></i> Edit
            </button>
            <button class="btn btn-sm btn-outline-danger flex-grow-1" (click)="removeJob(j)">
              <i class="bi bi-trash"></i> Delete
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && jobs.length === 0" class="text-center text-muted my-5">
    <i class="bi bi-emoji-frown fs-1 d-block mb-2"></i>
    <p>No jobs found</p>
  </div>

  <!-- Job Modal -->
  <div class="modal fade" id="jobModal" tabindex="-1" aria-labelledby="jobModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">

        <!-- Modal Body -->
        <div class="model">
          <div class="container">
            <!-- Modal Heading -->
            <div class="heading">
              <i class="bi bi-clipboard me-2"></i>
              {{ isEditing ? 'Edit Job' : 'Create Job' }}
            </div>

            <!-- Job Form -->
            <form class="form">
              <select class="input mb-2" [(ngModel)]="form.fieldId" name="fieldId" required>
                <option value="" disabled selected>Select Field</option>
                <option *ngFor="let f of fields" [value]="f._id">{{ f.name }} ({{ f.location }})</option>
              </select>

              <select class="input mb-2" [(ngModel)]="form.type" name="type" required>
                <option value="" disabled selected>Select Job Type</option>
                <option>Spraying</option>
                <option>Irrigation</option>
                <option>Harvesting</option>
                <option>Planting</option>
                <option>Maintenance</option>
                <option>Other</option>
              </select>

              <input type="datetime-local" class="input mb-2" [(ngModel)]="form.scheduledAt" name="scheduledAt" required>
              <textarea class="input mb-2" [(ngModel)]="form.notes" name="notes" placeholder="Notes"></textarea>

              <input class="login-button" type="button" value="Save" (click)="saveJob()" data-bs-dismiss="modal">
            </form>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
